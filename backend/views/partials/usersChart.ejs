<div
  class="w-full md:w-5/12 lg:w-2/5 rounded-xl shadow-md p-6"
  style="background-color: #ffffff; border: 2px solid #e5edfa"
>
  <h3
    class="text-lg md:text-xl font-bold mb-8"
    style="color: #0c0c22"
  >
    Distribución de usuarios
  </h3>
  <div id="usersChart" style="width: 100%; height: 350px"></div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
      const adminCount = <%= typeof chartData !== 'undefined' && chartData.adminCount !== undefined ? chartData.adminCount : 2 %>;
      const userNormalCount = <%= typeof chartData !== 'undefined' && chartData.userNormalCount !== undefined ? chartData.userNormalCount : 8 %>;
      const municipioCount = <%= typeof chartData !== 'undefined' && chartData.municipioCount !== undefined ? chartData.municipioCount : 1 %>;

      const usersChartDOM = document.getElementById('usersChart');
      if (usersChartDOM && typeof echarts !== 'undefined') {
          const usersChart = echarts.init(usersChartDOM);
          const usersOption = {
            tooltip: { trigger: 'item', formatter: '{b}: {c} ({d}%)' },
            legend: {
              orient: 'horizontal',
              bottom: 0,
              left: 'center'
            },
            series: [{
              name: 'Distribución',
              type: 'pie',
              radius: ['40%', '70%'],
              center: ['50%', '40%'],
              avoidLabelOverlap: false,
              label: {
                show: false,
                position: 'center'
              },
              emphasis: {
                label: {
                  show: false
                }
              },
              labelLine: {
                show: false
              },
              data: [
                { value: adminCount, name: 'Administradores', itemStyle: { color: '#004aad' } },
                { value: municipioCount, name: 'Municipios', itemStyle: { color: '#f59e0b' } },
                { value: userNormalCount, name: 'Usuarios', itemStyle: { color: '#92b2ea' } }
              ]
            }]
          };
          usersChart.setOption(usersOption);

          window.addEventListener('resize', function() {
            usersChart.resize();
          });
      }
  });
</script>
